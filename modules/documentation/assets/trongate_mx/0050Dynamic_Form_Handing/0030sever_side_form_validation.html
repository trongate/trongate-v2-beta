<h1>Server-side Form Validation</h1>

<p>One of the advantages of using Trongate MX is its seamless integration with Trongate's <a href="https://trongate.io/documentation-ref/list_refs/class_reference/the-validation-class">Form Validation Class</a>. This gives developers the opportunity to define and apply validation rules using Trongate’s default (traditional) <a href="https://trongate.io/documentation/display/php_framework/form-handling/setting-form-validation-rules">form validation techniques</a>.</p>

<p>With Trongate MX, you have full control over how server-side validation is handled. As a bonus, all submitted forms are automatically passed through Trongate's built-in CSRF protection protocol, ensuring your applications are safeguarded against malicious cross-site requests - all without any additional setup.</p>

<p>Let’s walk through an example.</p>

<h2>Example: Validating a Simple Form</h2>

<p>Suppose you have a form that collects a user's name and email address. You want to ensure that both fields are filled out and that the email address is valid. Here's how you could do it using Trongate MX:</p>

<h3>Step 1: Define Your Validation Rules</h3>

<p>Inside your method that handles the form submission, you can define form validation rules using the <span class="feature-ref">set_rules()</span> method, which is part of Trongate's <a href="https://trongate.io/documentation-ref/list_refs/class_reference/the-validation-class">Validation class</a>. For example:</p>

[code=php]
$this->validation->set_rules('name', 'Name', 'required|min_length[2]');
$this->validation->set_rules('email', 'Email Address', 'required|valid_email');
[/code]

<div class="alert alert-info">
  <p>If you prefer, you can define validation rules using array-based syntax. For example:</p>

[code=php]
$name_rules = [
  'required' => true,
  'min_length' => 2
]; 
$validation_rules['name'] = $name_rules;

$email_rules = [
  'required' => true,
  'valid_email' => true
];

$validation_rules['email'] = $email_rules;
[/code]
</div>

<h3 class="mt-3">Step 2: Run the Validation Tests</h3>

<p>After defining the rules, you can run the validation tests and respond accordingly, using the <span class="feature-ref" ref-path="class_reference/The_Validation_Class">run()</span> method:</p>

[code=php]
$result = $this->validation->run(); // Returns true or false.

if ($result === false) {
  // Validation failed
} else {
  // Continue with your business logic
}
[/code]

<h2>Built-in and Custom Validation Rules</h2>

<p>Trongate comes with a variety of built-in validation rules such as <code>required</code>, <code>valid_email</code>, <code>min_length</code>, and more. You can also create your own custom validation callbacks for scenarios where more specific checks are needed.</p>

<h2>Regarding Automatic CSRF Protection</h2>

<p>Whenever a form is submitted and validation is triggered using Trongate's Validation class, the framework silently enforces CSRF protection behind the scenes. This security measure requires the presence of a valid CSRF token, which ensures that only legitimate form submissions originating from your application will be accepted.</p>

<div class="alert alert-danger">
  <p>If you submit a form and use Trongate's <a href="https://trongate.io/documentation-ref/list_refs/class_reference/the-validation-class">Form Validation Class</a> to perform form validation tests, automatic CSRF protection will be activated. This means that the Trongate framework will check for the existence of a valid, posted CSRF token field.</p>

  <p><b>Without posting a valid CSRF token, forms will not be processed!</b></p>

  <p>Therefore, if you plan on using Trongate's Validation class, it's imperative to close forms by using Trongate's <code>form_close()</code> function. Trongate's <span class="feature-ref">form_close()</span> function automatically generates a valid, hidden CSRF token field. For more details, please refer to the Trongate PHP Framework documentation on '<a href="https://trongate.io/documentation/display/php_framework/form-handling/creating-forms">Creating Forms</a>'.</p>
</div>

<div class="alert alert-info">
  <p><strong>Learn More:</strong> For comprehensive information about CSRF protection in Trongate MX, including detailed security concepts and implementation details, visit the <a href="https://trongate.io/documentation/display/trongate_mx/trongate-mx-security/csrf-protection">CSRF Protection</a> page in the Trongate MX Security chapter.</p>
</div>

<h2>Conclusion</h2>

<p>Server-side form validation in Trongate MX is both robust and developer-friendly. Whether you choose to define your validation rules using traditional strings or array-based syntax, the process remains simple and highly effective. With automatic CSRF protection baked in, your forms gain an additional layer of security by default.</p>

<p>In the next section, we’ll look at how to elegantly display validation error messages to your users - ensuring your application communicates feedback with clarity and professionalism.</p>
